<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì£¼íƒ ì·¨ë“ì„¸ ê³„ì‚°ê¸°</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .card { background:#fff; border-radius:18px; box-shadow:0 12px 30px rgba(0,0,0,.12); }
    .label { font-weight:600; color:#374151 }
    .pill  { border:1px solid #e5e7eb; border-radius:10px; padding:10px 12px; }
  </style>
</head>
<body class="min-h-screen bg-gray-100">
  <main class="max-w-2xl mx-auto px-5 py-10">
    <section class="card p-7">
      <h1 class="text-2xl font-bold text-center text-indigo-700 mb-6">
        ì£¼íƒ ì·¨ë“ì„¸ ê³„ì‚°ê¸° ğŸ 
      </h1>

      <!-- ì£¼íƒ ìˆ˜ -->
      <div class="mb-4">
        <label for="house" class="label block mb-2">ì£¼íƒ ìˆ˜</label>
        <select id="house" class="pill w-full" onchange="toggleRegionBoxes()">
          <option value="1">1ì£¼íƒ</option>
          <option value="2">2ì£¼íƒ</option>
          <option value="3">3ì£¼íƒ ì´ìƒ</option>
        </select>
      </div>

      <!-- ê¸°ì¡´/ì¶”ê°€ ì£¼íƒ ì§€ì—­ (2ì£¼íƒì¼ ë•Œë§Œ ë…¸ì¶œ) -->
      <div id="regions" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4" style="display:none">
        <div>
          <label class="label block mb-2">ê¸°ì¡´ ì£¼íƒ ì§€ì—­</label>
          <select id="existRegion" class="pill w-full">
            <option value="non">ë¹„ì¡°ì •ì§€ì—­</option>
            <option value="reg">ì¡°ì •ì§€ì—­</option>
          </select>
        </div>
        <div>
          <label class="label block mb-2">ì¶”ê°€ ì£¼íƒ ì§€ì—­</label>
          <select id="addRegion" class="pill w-full">
            <option value="non">ë¹„ì¡°ì •ì§€ì—­</option>
            <option value="reg">ì¡°ì •ì§€ì—­</option>
          </select>
        </div>
      </div>

      <!-- ì·¨ë“ê°€ì•¡ -->
      <div class="mb-4">
        <label for="amount" class="label block mb-2">ì·¨ë“ê°€ì•¡ (ì›)</label>
        <input id="amount" type="text" class="pill w-full" placeholder="ì˜ˆ: 885,000,000" oninput="formatAmount(this)"/>
      </div>

      <!-- ë©´ì  -->
      <div class="mb-6">
        <span class="label block mb-2">ë©´ì </span>
        <label class="mr-6">
          <input type="radio" name="area" value="small" checked> 85ã¡ ì´í•˜
        </label>
        <label>
          <input type="radio" name="area" value="large"> 85ã¡ ì´ˆê³¼
        </label>
      </div>

      <button onclick="calculate()" class="w-full py-3 rounded-xl text-white font-bold bg-indigo-600 hover:bg-indigo-700 transition">
        ê³„ì‚°í•˜ê¸°
      </button>

      <!-- ê²°ê³¼ -->
      <div id="resultCard" class="mt-7 p-5 rounded-xl bg-indigo-50" style="display:none">
        <h2 class="text-lg font-bold text-indigo-700 mb-3">ê³„ì‚° ê²°ê³¼</h2>
        <div class="space-y-1 text-gray-800">
          <p id="lineAcq"></p>
          <p id="lineEdu"></p>
          <p id="lineRural"></p>
          <hr class="my-3">
          <p id="lineTotal" class="text-red-600 font-bold"></p>
        </div>
        <p class="text-xs text-gray-500 mt-3">
          * 6~9ì–µ êµ¬ê°„ ê¸°ë³¸ì„¸ìœ¨: ì„¸ìœ¨(%) = ì·¨ë“ê°€ì•¡(ì–µì›) Ã— 2/3 âˆ’ 3<br>
          * êµìœ¡ì„¸ëŠ” ì·¨ë“ì„¸ì˜ 10%, ë†íŠ¹ì„¸ëŠ” 85ã¡ ì´ˆê³¼ ì‹œ ì·¨ë“ì„¸ì˜ 20%ë¡œ ê°€ì •.
        </p>
      </div>
    </section>
  </main>

  <script>
    // ì²œ ë‹¨ìœ„ ì½¤ë§ˆ
    function formatAmount(el){
      const raw = el.value.replace(/[^\d]/g, "");
      el.value = raw ? Number(raw).toLocaleString() : "";
    }

    function toggleRegionBoxes(){
      const house = document.getElementById('house').value;
      document.getElementById('regions').style.display = (house === '2') ? 'grid' : 'none';
    }

    // 1ì£¼íƒ ê¸°ë³¸ì„¸ìœ¨(ì†Œìˆ˜, ì˜ˆ: 0.029)
    function basicRate(priceWon){
      if (priceWon <= 600_000_000) return 0.01;
      if (priceWon <= 900_000_000){
        const eok = priceWon / 100_000_000;                 // ì–µì› ë‹¨ìœ„
        let pct = eok * (2/3) - 3;                          // % ë‹¨ìœ„ (1~3 ì‚¬ì´)
        if (pct < 1) pct = 1;
        if (pct > 3) pct = 3;
        return pct / 100;                                   // ì†Œìˆ˜ë¡œ ë³€í™˜
      }
      return 0.03;
    }

    function calculate(){
      const amountStr = document.getElementById('amount').value.replace(/,/g,"");
      if(!amountStr){ alert("ì·¨ë“ê°€ì•¡ì„ ì…ë ¥í•˜ì„¸ìš”."); return; }
      const price = Number(amountStr);

      const house = document.getElementById('house').value;
      const area = document.querySelector('input[name="area"]:checked').value;
      const addRegion = document.getElementById('addRegion')?.value || 'non';

      // ì·¨ë“ì„¸ìœ¨ ê²°ì •
      let acqRate;
      if (house === '1'){
        acqRate = basicRate(price);
      } else if (house === '2'){
        // ì¶”ê°€ ì£¼íƒ ì§€ì—­ì´ ì¡°ì •ì§€ì—­ì´ë©´ ì¤‘ê³¼, ë¹„ì¡°ì •ì´ë©´ ê¸°ë³¸ì„¸ìœ¨
        acqRate = (addRegion === 'reg') ? 0.08 : basicRate(price);
      } else { // 3ì£¼íƒ ì´ìƒ
        acqRate = 0.12;
      }

      const eduRate   = acqRate * 0.10;                    // êµìœ¡ì„¸ = ì·¨ë“ì„¸ì˜ 10%
      const ruralRate = (area === 'large') ? acqRate*0.20 : 0; // ë†íŠ¹ì„¸ = ë©´ì  85ì´ˆê³¼ë©´ ì·¨ë“ì„¸ì˜ 20%

      // ì„¸ì•¡ ê³„ì‚° (ì›)
      const acqTax   = Math.round(price * acqRate);
      const eduTax   = Math.round(price * eduRate);
      const ruralTax = Math.round(price * ruralRate);
      const total    = acqTax + eduTax + ruralTax;

      // ì¶œë ¥(ì„¸ìœ¨ì€ % í‘œì‹œ)
      document.getElementById('lineAcq').textContent =
        `ì·¨ë“ì„¸: ${acqTax.toLocaleString()} ì› (${(acqRate*100).toFixed(2)}% ì ìš©)`;
      document.getElementById('lineEdu').textContent =
        `êµìœ¡ì„¸: ${eduTax.toLocaleString()} ì› (ì·¨ë“ì„¸ì˜ 10% â†’ ${(eduRate*100).toFixed(2)}%)`;
      document.getElementById('lineRural').textContent =
        `ë†íŠ¹ì„¸: ${ruralTax.toLocaleString()} ì› ${area==='large' ? `(ì·¨ë“ì„¸ì˜ 20% â†’ ${(ruralRate*100).toFixed(2)}%)` : `(0%)`}`;
      document.getElementById('lineTotal').textContent =
        `ì´ ì„¸ì•¡: ${total.toLocaleString()} ì›`;

      document.getElementById('resultCard').style.display = 'block';
    }
  </script>
</body>
</html>
