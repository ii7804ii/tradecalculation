<div class="result" id="result">ì·¨ë“ì„¸: -</div>
<div class="breakdown" id="breakdown"></div>
<div class="note">* ì„¸ìœ¨ì€ ì¡°ê±´ì— ë”°ë¼ ìë™ ê³„ì‚°ë©ë‹ˆë‹¤.</div>

<script>
  function calculate() {
    let amount = document.getElementById('amount').value.replace(/,/g, '');
    let area = document.getElementById('area').value;
    let houseCount = document.getElementById('houseCount').value;
    let region1 = document.getElementById('region1') ? document.getElementById('region1').value : null;
    let region2 = document.getElementById('region2') ? document.getElementById('region2').value : null;
    let resultDiv = document.getElementById('result');
    let breakdownDiv = document.getElementById('breakdown');

    if (!amount) {
      alert("ê±°ë˜ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”.");
      return;
    }

    amount = Number(amount);

    // ----------------------
    // ì„¸ìœ¨ ì´ˆê¸°í™”
    let ì·¨ë“ì„¸ìœ¨ = 0;
    let êµìœ¡ì„¸ìœ¨ = 0;
    let ë†íŠ¹ì„¸ìœ¨ = 0;
    // ----------------------

    // âœ… 1ì£¼íƒ
    if (houseCount === "1") {
      if (amount <= 600000000) {
        ì·¨ë“ì„¸ìœ¨ = 0.01;
        êµìœ¡ì„¸ìœ¨ = 0.001;
      } else if (amount <= 900000000) {
        // (ì·¨ë“ê°€ì•¡Ã—2/3)-3% ê³µì‹ ì ìš©
        ì·¨ë“ì„¸ìœ¨ = (amount * (2/3) / amount) - 0.03;
        if (ì·¨ë“ì„¸ìœ¨ < 0.01) ì·¨ë“ì„¸ìœ¨ = 0.01; // ìµœì†Œ 1%
        if (ì·¨ë“ì„¸ìœ¨ > 0.03) ì·¨ë“ì„¸ìœ¨ = 0.03; // ìµœëŒ€ 3%
        êµìœ¡ì„¸ìœ¨ = ì·¨ë“ì„¸ìœ¨ * 0.1; // ë¹„ìœ¨ ë™ì¼í•˜ê²Œ ì¦ê°€
      } else {
        ì·¨ë“ì„¸ìœ¨ = 0.03;
        êµìœ¡ì„¸ìœ¨ = 0.003;
      }
    }
    // âœ… 2ì£¼íƒ (ê°„ë‹¨ ì ìš©: ì¶”ê°€ì£¼íƒì´ ì¡°ì •ì§€ì—­ì´ë©´ ì¤‘ê³¼)
    else if (houseCount === "2") {
      if (region2 === "regulated") {
        ì·¨ë“ì„¸ìœ¨ = 0.08;
      } else {
        ì·¨ë“ì„¸ìœ¨ = 0.01;
      }
      êµìœ¡ì„¸ìœ¨ = ì·¨ë“ì„¸ìœ¨ * 0.1;
    }
    // âœ… 3ì£¼íƒ ì´ìƒ
    else {
      ì·¨ë“ì„¸ìœ¨ = 0.12;
      êµìœ¡ì„¸ìœ¨ = ì·¨ë“ì„¸ìœ¨ * 0.1; // ë³´í†µ 10% ë¶€ê³¼
    }

    // âœ… ë†íŠ¹ì„¸ (85mÂ² ì´ˆê³¼ ì‹œ 0.2% ì¶”ê°€)
    if (area === "large") {
      ë†íŠ¹ì„¸ìœ¨ = 0.002;
    }

    // ----------------------
    // ì„¸ê¸ˆ ê³„ì‚°
    let ì·¨ë“ì„¸ = amount * ì·¨ë“ì„¸ìœ¨;
    let êµìœ¡ì„¸ = amount * êµìœ¡ì„¸ìœ¨;
    let ë†íŠ¹ì„¸ = amount * ë†íŠ¹ì„¸ìœ¨;
    let í•©ê³„ = ì·¨ë“ì„¸ + êµìœ¡ì„¸ + ë†íŠ¹ì„¸;
    // ----------------------

    // ê²°ê³¼ ì¶œë ¥
    resultDiv.innerText = "ì´ ì·¨ë“ì„¸: " + Math.round(í•©ê³„).toLocaleString() + " ì›";

    breakdownDiv.innerHTML = `
      <hr>
      <p>ğŸ“Œ ì„¸ë¶€ ë‚´ì—­</p>
      <p>ì·¨ë“ì„¸ (${(ì·¨ë“ì„¸ìœ¨*100).toFixed(2)}%) : ${Math.round(ì·¨ë“ì„¸).toLocaleString()} ì›</p>
      <p>ì§€ë°©êµìœ¡ì„¸ (${(êµìœ¡ì„¸ìœ¨*100).toFixed(2)}%) : ${Math.round(êµìœ¡ì„¸).toLocaleString()} ì›</p>
      <p>ë†ì–´ì´ŒíŠ¹ë³„ì„¸ (${(ë†íŠ¹ì„¸ìœ¨*100).toFixed(2)}%) : ${Math.round(ë†íŠ¹ì„¸).toLocaleString()} ì›</p>
      <p><b>í•©ê³„ : ${Math.round(í•©ê³„).toLocaleString()} ì›</b></p>
    `;
  }
</script>
