<div class="result" id="result">취득세: -</div>
<div class="breakdown" id="breakdown"></div>
<div class="note">* 세율은 조건에 따라 자동 계산됩니다.</div>

<script>
  function calculate() {
    let amount = document.getElementById('amount').value.replace(/,/g, '');
    let area = document.getElementById('area').value;
    let houseCount = document.getElementById('houseCount').value;
    let region1 = document.getElementById('region1') ? document.getElementById('region1').value : null;
    let region2 = document.getElementById('region2') ? document.getElementById('region2').value : null;
    let resultDiv = document.getElementById('result');
    let breakdownDiv = document.getElementById('breakdown');

    if (!amount) {
      alert("거래 금액을 입력하세요.");
      return;
    }

    amount = Number(amount);

    // ----------------------
    // 세율 초기화
    let 취득세율 = 0;
    let 교육세율 = 0;
    let 농특세율 = 0;
    // ----------------------

    // ✅ 1주택
    if (houseCount === "1") {
      if (amount <= 600000000) {
        취득세율 = 0.01;
        교육세율 = 0.001;
      } else if (amount <= 900000000) {
        // (취득가액×2/3)-3% 공식 적용
        취득세율 = (amount * (2/3) / amount) - 0.03;
        if (취득세율 < 0.01) 취득세율 = 0.01; // 최소 1%
        if (취득세율 > 0.03) 취득세율 = 0.03; // 최대 3%
        교육세율 = 취득세율 * 0.1; // 비율 동일하게 증가
      } else {
        취득세율 = 0.03;
        교육세율 = 0.003;
      }
    }
    // ✅ 2주택 (간단 적용: 추가주택이 조정지역이면 중과)
    else if (houseCount === "2") {
      if (region2 === "regulated") {
        취득세율 = 0.08;
      } else {
        취득세율 = 0.01;
      }
      교육세율 = 취득세율 * 0.1;
    }
    // ✅ 3주택 이상
    else {
      취득세율 = 0.12;
      교육세율 = 취득세율 * 0.1; // 보통 10% 부과
    }

    // ✅ 농특세 (85m² 초과 시 0.2% 추가)
    if (area === "large") {
      농특세율 = 0.002;
    }

    // ----------------------
    // 세금 계산
    let 취득세 = amount * 취득세율;
    let 교육세 = amount * 교육세율;
    let 농특세 = amount * 농특세율;
    let 합계 = 취득세 + 교육세 + 농특세;
    // ----------------------

    // 결과 출력
    resultDiv.innerText = "총 취득세: " + Math.round(합계).toLocaleString() + " 원";

    breakdownDiv.innerHTML = `
      <hr>
      <p>📌 세부 내역</p>
      <p>취득세 (${(취득세율*100).toFixed(2)}%) : ${Math.round(취득세).toLocaleString()} 원</p>
      <p>지방교육세 (${(교육세율*100).toFixed(2)}%) : ${Math.round(교육세).toLocaleString()} 원</p>
      <p>농어촌특별세 (${(농특세율*100).toFixed(2)}%) : ${Math.round(농특세).toLocaleString()} 원</p>
      <p><b>합계 : ${Math.round(합계).toLocaleString()} 원</b></p>
    `;
  }
</script>
